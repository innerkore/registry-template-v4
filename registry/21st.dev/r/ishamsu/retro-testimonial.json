{
  "name": "retro-testimonial",
  "type": "registry:block",
  "dependencies": [
    "next",
    "lucide-react",
    "framer-motion"
  ],
  "files": [
    {
      "path": "/components/blocks/retro-testimonial.tsx",
      "type": "registry:block",
      "content": "\"use client\";\n\nimport React, {useEffect, useRef, useState} from \"react\";\n\nimport Image from \"next/image\";\nimport {AnimatePresence, motion} from \"framer-motion\";\nimport {ImageProps} from \"next/image\";\nimport {ArrowLeft, ArrowRight, Quote, X} from \"lucide-react\";\n\nimport {cn} from \"@/lib/utils\";\n\n// ===== Types and Interfaces =====\nexport interface iTestimonial {\n\tname: string;\n\tdesignation: string;\n\tdescription: string;\n\tprofileImage: string;\n}\n\ninterface iCarouselProps {\n\titems: React.ReactElement<{\n\t\ttestimonial: iTestimonial;\n\t\tindex: number;\n\t\tlayout?: boolean;\n\t\tonCardClose: () => void;\n\t}>[];\n\tinitialScroll?: number;\n}\n\n// ===== Custom Hooks =====\nconst useOutsideClick = (\n\tref: React.RefObject<HTMLDivElement | null>,\n\tonOutsideClick: () => void,\n) => {\n\tuseEffect(() => {\n\t\tconst handleClickOutside = (event: MouseEvent | TouchEvent) => {\n\t\t\tif (!ref.current || ref.current.contains(event.target as Node)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tonOutsideClick();\n\t\t};\n\n\t\tdocument.addEventListener(\"mousedown\", handleClickOutside);\n\t\tdocument.addEventListener(\"touchstart\", handleClickOutside);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"mousedown\", handleClickOutside);\n\t\t\tdocument.removeEventListener(\"touchstart\", handleClickOutside);\n\t\t};\n\t}, [ref, onOutsideClick]);\n};\n\n// ===== Components =====\nconst Carousel = ({items, initialScroll = 0}: iCarouselProps) => {\n\tconst carouselRef = React.useRef<HTMLDivElement>(null);\n\tconst [canScrollLeft, setCanScrollLeft] = React.useState(false);\n\tconst [canScrollRight, setCanScrollRight] = React.useState(true);\n\n\tconst checkScrollability = () => {\n\t\tif (carouselRef.current) {\n\t\t\tconst {scrollLeft, scrollWidth, clientWidth} = carouselRef.current;\n\t\t\tsetCanScrollLeft(scrollLeft > 0);\n\t\t\tsetCanScrollRight(scrollLeft < scrollWidth - clientWidth);\n\t\t}\n\t};\n\n\tconst handleScrollLeft = () => {\n\t\tif (carouselRef.current) {\n\t\t\tcarouselRef.current.scrollBy({left: -300, behavior: \"smooth\"});\n\t\t}\n\t};\n\n\tconst handleScrollRight = () => {\n\t\tif (carouselRef.current) {\n\t\t\tcarouselRef.current.scrollBy({left: 300, behavior: \"smooth\"});\n\t\t}\n\t};\n\n\tconst handleCardClose = (index: number) => {\n\t\tif (carouselRef.current) {\n\t\t\tconst cardWidth = isMobile() ? 230 : 384;\n\t\t\tconst gap = isMobile() ? 4 : 8;\n\t\t\tconst scrollPosition = (cardWidth + gap) * (index + 1);\n\t\t\tcarouselRef.current.scrollTo({\n\t\t\t\tleft: scrollPosition,\n\t\t\t\tbehavior: \"smooth\",\n\t\t\t});\n\t\t}\n\t};\n\n\tconst isMobile = () => {\n\t\treturn window && window.innerWidth < 768;\n\t};\n\n\tuseEffect(() => {\n\t\tif (carouselRef.current) {\n\t\t\tcarouselRef.current.scrollLeft = initialScroll;\n\t\t\tcheckScrollability();\n\t\t}\n\t}, [initialScroll]);\n\n\treturn (\n\t\t<div className=\"relative w-full mt-10\">\n\t\t\t<div\n\t\t\t\tclassName=\"flex w-full overflow-x-scroll overscroll-x-auto scroll-smooth [scrollbar-width:none] py-5\"\n\t\t\t\tref={carouselRef}\n\t\t\t\tonScroll={checkScrollability}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"absolute right-0 z-[1000] h-auto w-[5%] overflow-hidden bg-gradient-to-l\",\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"flex flex-row justify-start gap-4 pl-3\",\n\t\t\t\t\t\t\"max-w-5xl mx-auto\",\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t{items.map((item, index) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\t\tinitial={{opacity: 0, y: 20}}\n\t\t\t\t\t\t\t\tanimate={{\n\t\t\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\t\ttransition: {\n\t\t\t\t\t\t\t\t\t\tduration: 0.5,\n\t\t\t\t\t\t\t\t\t\tdelay: 0.2 * index,\n\t\t\t\t\t\t\t\t\t\tease: \"easeOut\",\n\t\t\t\t\t\t\t\t\t\tonce: true,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tkey={`card-${index}`}\n\t\t\t\t\t\t\t\tclassName=\"last:pr-[5%] md:last:pr-[33%] rounded-3xl\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{React.cloneElement(item, {\n\t\t\t\t\t\t\t\t\tonCardClose: () => {\n\t\t\t\t\t\t\t\t\t\treturn handleCardClose(index);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</motion.div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"flex justify-end gap-2 mt-4\">\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"relative z-40 h-10 w-10 rounded-full bg-[#4b3f33] flex items-center justify-center disabled:opacity-50 hover:bg-[#4b3f33]/80 transition-colors duration-200\"\n\t\t\t\t\tonClick={handleScrollLeft}\n\t\t\t\t\tdisabled={!canScrollLeft}\n\t\t\t\t>\n\t\t\t\t\t<ArrowLeft className=\"h-6 w-6 text-[#f2f0eb]\" />\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"relative z-40 h-10 w-10 rounded-full bg-[#4b3f33] flex items-center justify-center disabled:opacity-50 hover:bg-[#4b3f33]/80 transition-colors duration-200\"\n\t\t\t\t\tonClick={handleScrollRight}\n\t\t\t\t\tdisabled={!canScrollRight}\n\t\t\t\t>\n\t\t\t\t\t<ArrowRight className=\"h-6 w-6 text-[#f2f0eb]\" />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nconst TestimonialCard = ({\n\ttestimonial,\n\tindex,\n\tlayout = false,\n\tonCardClose = () => {},\n\tbackgroundImage = \"https://images.unsplash.com/photo-1686806372726-388d03ff49c8?q=80&w=3087&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D\",\n}: {\n\ttestimonial: iTestimonial;\n\tindex: number;\n\tlayout?: boolean;\n\tonCardClose?: () => void;\n\tbackgroundImage?: string;\n}) => {\n\tconst [isExpanded, setIsExpanded] = useState(false);\n\tconst containerRef = useRef<HTMLDivElement>(null);\n\n\tconst handleExpand = () => {\n\t\treturn setIsExpanded(true);\n\t};\n\tconst handleCollapse = () => {\n\t\tsetIsExpanded(false);\n\t\tonCardClose();\n\t};\n\n\tuseEffect(() => {\n\t\tconst handleEscapeKey = (event: KeyboardEvent) => {\n\t\t\tif (event.key === \"Escape\") {\n\t\t\t\thandleCollapse();\n\t\t\t}\n\t\t};\n\n\t\tif (isExpanded) {\n\t\t\tconst scrollY = window.scrollY;\n\t\t\tdocument.body.style.position = \"fixed\";\n\t\t\tdocument.body.style.top = `-${scrollY}px`;\n\t\t\tdocument.body.style.width = \"100%\";\n\t\t\tdocument.body.style.overflow = \"hidden\";\n\t\t\tdocument.body.dataset.scrollY = scrollY.toString();\n\t\t} else {\n\t\t\tconst scrollY = parseInt(document.body.dataset.scrollY || \"0\", 10);\n\t\t\tdocument.body.style.position = \"\";\n\t\t\tdocument.body.style.top = \"\";\n\t\t\tdocument.body.style.width = \"\";\n\t\t\tdocument.body.style.overflow = \"\";\n\t\t\twindow.scrollTo({top: scrollY, behavior: \"instant\"});\n\t\t}\n\n\t\twindow.addEventListener(\"keydown\", handleEscapeKey);\n\t\treturn () => {\n\t\t\treturn window.removeEventListener(\"keydown\", handleEscapeKey);\n\t\t};\n\t}, [isExpanded]);\n\n\tuseOutsideClick(containerRef, handleCollapse);\n\n\treturn (\n\t\t<>\n\t\t\t<AnimatePresence>\n\t\t\t\t{isExpanded && (\n\t\t\t\t\t<div className=\"fixed inset-0 h-screen overflow-hidden z-50\">\n\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\tinitial={{opacity: 0}}\n\t\t\t\t\t\t\tanimate={{opacity: 1}}\n\t\t\t\t\t\t\texit={{opacity: 0}}\n\t\t\t\t\t\t\tclassName=\"bg-red backdrop-blur-lg h-full w-full fixed inset-0\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<motion.div\n\t\t\t\t\t\t\tinitial={{opacity: 0}}\n\t\t\t\t\t\t\tanimate={{opacity: 1}}\n\t\t\t\t\t\t\texit={{opacity: 0}}\n\t\t\t\t\t\t\tref={containerRef}\n\t\t\t\t\t\t\tlayoutId={layout ? `card-${testimonial.name}` : undefined}\n\t\t\t\t\t\t\tclassName=\"max-w-5xl mx-auto bg-gradient-to-b from-[#f2f0eb] to-[#fff9eb] h-full z-[60] p-4 md:p-10 rounded-3xl relative md:mt-10\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclassName=\"sticky top-4 h-8 w-8 right-0 ml-auto rounded-full flex items-center justify-center bg-[#4b3f33]\"\n\t\t\t\t\t\t\t\tonClick={handleCollapse}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<X className=\"h-6 w-6 text-white dark:text-neutral-900 absolute\" />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<motion.p\n\t\t\t\t\t\t\t\tlayoutId={layout ? `category-${testimonial.name}` : undefined}\n\t\t\t\t\t\t\t\tclassName=\"px-0 md:px-20 text-[rgba(31, 27, 29, 0.7)] text-lg dark:text-white font-thin font-tiemposHeadline underline underline-offset-8\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{testimonial.designation}\n\t\t\t\t\t\t\t</motion.p>\n\t\t\t\t\t\t\t<motion.p\n\t\t\t\t\t\t\t\tlayoutId={layout ? `title-${testimonial.name}` : undefined}\n\t\t\t\t\t\t\t\tclassName=\"px-0 md:px-20 text-2xl md:text-4xl font-normal italic text-[rgba(31, 27, 29, 0.7)] mt-4 dark:text-white font-tiemposHeadline lowercase\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{testimonial.name}\n\t\t\t\t\t\t\t</motion.p>\n\t\t\t\t\t\t\t<div className=\"py-8 text-[rgba(31, 27, 29, 0.7)] px-0 md:px-20 text-3xl lowercase font-thin font-tiemposHeadline leading-snug tracking-wide\">\n\t\t\t\t\t\t\t\t<Quote className=\"h-6 w-6 text-[rgba(31, 27, 29, 0.7)] dark:text-neutral-900\" />\n\t\t\t\t\t\t\t\t{testimonial.description}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</motion.div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</AnimatePresence>\n\t\t\t<motion.button\n\t\t\t\tlayoutId={layout ? `card-${testimonial.name}` : undefined}\n\t\t\t\tonClick={handleExpand}\n\t\t\t\tclassName=\"\"\n\t\t\t\twhileHover={{\n\t\t\t\t\trotateX: 2,\n\t\t\t\t\trotateY: 2,\n\t\t\t\t\trotate: 3,\n\t\t\t\t\tscale: 1.02,\n\t\t\t\t\ttransition: {duration: 0.3, ease: \"easeOut\"},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={`${index % 2 === 0 ? \"rotate-0\" : \"-rotate-0\"} rounded-3xl bg-gradient-to-b from-[#f2f0eb] to-[#fff9eb] h-[500px] md:h-[550px] w-80 md:w-96 overflow-hidden flex flex-col items-center justify-center relative z-10 shadow-md`}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"absolute opacity-30\" style={{inset: \"-1px 0 0\"}}>\n\t\t\t\t\t\t<div className=\"absolute inset-0\">\n\t\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\t\tclassName=\"block w-full h-full object-center object-cover\"\n\t\t\t\t\t\t\t\tsrc={backgroundImage}\n\t\t\t\t\t\t\t\talt=\"Background layer\"\n\t\t\t\t\t\t\t\tlayout=\"fill\"\n\t\t\t\t\t\t\t\tobjectFit=\"cover\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ProfileImage src={testimonial.profileImage} alt={testimonial.name} />\n\t\t\t\t\t<motion.p\n\t\t\t\t\t\tlayoutId={layout ? `title-${testimonial.name}` : undefined}\n\t\t\t\t\t\tclassName=\"text-[rgba(31, 27, 29, 0.7)] text-2xl md:text-2xl font-normal text-center [text-wrap:balance] font-tiemposHeadline mt-4 lowercase px-3\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{testimonial.description.length > 100\n\t\t\t\t\t\t\t? `${testimonial.description.slice(0, 100)}...`\n\t\t\t\t\t\t\t: testimonial.description}\n\t\t\t\t\t</motion.p>\n\t\t\t\t\t<motion.p\n\t\t\t\t\t\tlayoutId={layout ? `category-${testimonial.name}` : undefined}\n\t\t\t\t\t\tclassName=\"text-[rgba(31, 27, 29, 0.7)] text-xl md:text-2xl font-thin font-tiemposHeadline italic text-center mt-5 lowercase\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{testimonial.name}.\n\t\t\t\t\t</motion.p>\n\t\t\t\t\t<motion.p\n\t\t\t\t\t\tlayoutId={layout ? `category-${testimonial.name}` : undefined}\n\t\t\t\t\t\tclassName=\"text-[rgba(31, 27, 29, 0.7)] text-base md:text-base font-thin font-tiemposHeadline italic text-center mt-1 lowercase underline underline-offset-8 decoration-1\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{testimonial.designation.length > 25\n\t\t\t\t\t\t\t? `${testimonial.designation.slice(0, 25)}...`\n\t\t\t\t\t\t\t: testimonial.designation}\n\t\t\t\t\t</motion.p>\n\t\t\t\t</div>\n\t\t\t</motion.button>\n\t\t</>\n\t);\n};\n\nconst ProfileImage = ({src, alt, ...rest}: ImageProps) => {\n\tconst [isLoading, setLoading] = useState(true);\n\n\treturn (\n\t\t<div className=\"w-[90px] h-[90px] md:w-[150px] md:h-[150px] opacity-80 overflow-hidden rounded-[1000px] border-[3px] border-solid border-[rgba(59,59,59,0.6)] aspect-[1/1] flex-none saturate-[0.2] sepia-[0.46] relative\">\n\t\t\t<Image\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"transition duration-300 absolute top-0 inset-0 rounded-inherit object-cover z-50\",\n\t\t\t\t\tisLoading ? \"blur-sm\" : \"blur-0\",\n\t\t\t\t)}\n\t\t\t\tonLoad={() => {\n\t\t\t\t\treturn setLoading(false);\n\t\t\t\t}}\n\t\t\t\tsrc={src}\n\t\t\t\twidth={150}\n\t\t\t\theight={150}\n\t\t\t\tloading=\"lazy\"\n\t\t\t\tdecoding=\"async\"\n\t\t\t\tblurDataURL={typeof src === \"string\" ? src : undefined}\n\t\t\t\talt={alt || \"Profile image\"}\n\t\t\t\t{...rest}\n\t\t\t/>\n\t\t</div>\n\t);\n};\n\n// Export the components\nexport {Carousel, TestimonialCard, ProfileImage};\n"
    }
  ],
  "tailwind": {
    "config": {}
  },
  "meta": {
    "imported_from": "https://21st.dev/r/ishamsu/retro-testimonial"
  }
}